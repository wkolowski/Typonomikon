<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-3.5.1.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
<title>Typonomikon</title>
</head>
<h1 class="libtitle">F1: Koindukcja i korekursja [TODO]</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Set&nbsp;Warnings&nbsp;"+cannot-define-projection".<br/>
<span class="comment">(*&nbsp;Set&nbsp;Warnings&nbsp;"+non-primitive-record".&nbsp;*)</span><br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FunctionalExtensionality</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Setoid</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FinFun</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">NArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Div2</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab678"></a><h1 class="section">Koindukcja (TODO)</h1>

<div class="paragraph"> </div>

<a id="lab679"></a><h2 class="section">Nanana Batman! (TODO)</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Record</span>.<br/>

<br/>
#[<span class="id" title="var">projections</span>(<span class="id" title="var">primitive</span>)]<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">product</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Pair</span><br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">outl</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">outr</span> : <span class="id" title="var">B</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outl</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_product</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span> : <span class="id" title="var">product</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">outl</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outl</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">outr</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outr</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> [<span class="id" title="var">a1</span> <span class="id" title="var">b1</span>] [<span class="id" title="var">a2</span> <span class="id" title="var">b2</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> -&gt; -&gt;.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="keyword">Record</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Inductive</span>.<br/>

<br/>
#[<span class="id" title="var">projections</span>(<span class="id" title="var">primitive</span>)]<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">product</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Pair</span><br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">outl</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">outr</span> : <span class="id" title="var">B</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outl</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_product</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span> : <span class="id" title="var">product</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">outl</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outl</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">outr</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outr</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> [<span class="id" title="var">a1</span> <span class="id" title="var">b1</span>] [<span class="id" title="var">a2</span> <span class="id" title="var">b2</span>]; <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="keyword">Inductive</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">CoInductive</span>.<br/>

<br/>
#[<span class="id" title="var">projections</span>(<span class="id" title="var">primitive</span>)]<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">product</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Pair</span><br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">outl</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">outr</span> : <span class="id" title="var">B</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outl</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">outr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_product</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span> : <span class="id" title="var">product</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">outl</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outl</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">outr</span> <span class="id" title="var">p1</span> = <span class="id" title="var">outr</span> <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> [<span class="id" title="var">a1</span> <span class="id" title="var">b1</span>] [<span class="id" title="var">a2</span> <span class="id" title="var">b2</span>]; <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="keyword">CoInductive</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab680"></a><h2 class="section">Drzewka (TODO)</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">coBTree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> : <span class="id" title="var">option</span> (<span class="id" title="var">coBTree</span> <span class="id" title="var">A</span> * <span class="id" title="var">A</span> * <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>)<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">root</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">fmap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">B</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>, <span class="id" title="var">f</span> <span class="id" title="var">v</span>, <span class="id" title="var">fmap</span> <span class="id" title="var">f</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">ns</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">ns</span> (1 + 2 * <span class="id" title="var">n</span>), <span class="id" title="var">n</span>, <span class="id" title="var">ns</span> (2 + 2 * <span class="id" title="var">n</span>))<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">BTree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">Empty</span> : <span class="id" title="var">BTree</span> <span class="id" title="var">A</span><br/>
| <span class="id" title="var">Node</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Empty</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Node</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ttake</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
| 0 =&gt; <span class="id" title="var">Empty</span><br/>
| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">Empty</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Node</span> <span class="id" title="var">v</span> (<span class="id" title="var">ttake</span> <span class="id" title="var">n'</span> <span class="id" title="var">l</span>) (<span class="id" title="var">ttake</span> <span class="id" title="var">n'</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">ttake</span> 5 (<span class="id" title="var">ns</span> 0).<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">tsim</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">tsim'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t1</span> = <span class="id" title="var">None</span> /\ <span class="id" title="var">root</span> <span class="id" title="var">t2</span> = <span class="id" title="var">None</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">v1</span> <span class="id" title="var">v2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t1</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">l1</span>, <span class="id" title="var">v1</span>, <span class="id" title="var">r1</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t2</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">l2</span>, <span class="id" title="var">v2</span>, <span class="id" title="var">r2</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tsim</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> /\ <span class="id" title="var">tsim</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">mirror</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">r</span>, <span class="id" title="var">v</span>, <span class="id" title="var">mirror</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tsim_mirror_inv</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tsim</span> (<span class="id" title="var">mirror</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">t</span>)) <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="var">Admitted</span>.<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;cofix&nbsp;CH.<br/>
&nbsp;&nbsp;destruct&nbsp;t&nbsp;as&nbsp;<span class="inlinecode">[[[<span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">v</span>]</span> <span class="inlinecode"><span class="id" title="var">r</span>]|]</span>;&nbsp;constructor;&nbsp;<span class="inlinecode"><span class="id" title="tactic">right</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="tactic">left</span></span>.&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;v,&nbsp;v,&nbsp;(mirror&nbsp;(mirror&nbsp;l)),&nbsp;l,&nbsp;(mirror&nbsp;(mirror&nbsp;r)),&nbsp;r.&nbsp;auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auto.<br/>
Qed.<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab681"></a><h2 class="section">Rekursja ogólna (TODO)</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Typonomikon</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">F4</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab682"></a><h4 class="section">Ćwiczenie</h4>

<div class="paragraph"> </div>

 Znajdź taką rodzinę typów koinduktywnych <span class="inlinecode"><span class="id" title="var">C</span></span>, że dla dowolnego
    typu <span class="inlinecode"><span class="id" title="var">A</span></span>, <span class="inlinecode"><span class="id" title="var">C</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> jest w bijekcji z typem funkcji <span class="inlinecode"><span class="id" title="var">nat</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">A</span></span>. Przez
    bijekcję będziemy tu rozumieć funkcję, która ma odwrotność, z którą
    w obie strony składa się do identyczności.

<div class="paragraph"> </div>

    Uwaga: nie da się tego udowodnić bez użycia dodatkowych aksjomatów,
    które na szczęście są bardzo oczywiste i same się narzucają. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a id="lab683"></a><h4 class="section">Ćwiczenie</h4>

<div class="paragraph"> </div>

 Zdefiniuj pojęcie "nieskończonego łańcucha malejącego" (oczywiście
    za pomocą koindukcji) i udowodnij, że jeżeli relacja jest dobrze
    ufundowana, to nie ma nieskończonych łańcuchów malejących. 
</div>
<div class="code">

<br/>
</div>
