<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-3.5.1.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
<title>Typonomikon</title>
</head>
<h1 class="libtitle">F2: Strumienie [TODO]</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>
<span class="comment">(*&nbsp;Set&nbsp;Warnings&nbsp;"+cannot-define-projection".<br/>
<span class="comment">(*&nbsp;Set&nbsp;Warnings&nbsp;"+non-primitive-record".&nbsp;*)</span>&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
W tym rozdziale będą ćwiczenia dotyczące strumieni, czyli ogólnie
    wesołe koinduktywne zabawy, o których jeszcze nic nie napisałem. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Stream</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Cons</span><br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">hd</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">tl</span> {<span class="id" title="var">A</span>}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab666"></a><h1 class="section">Bipodobieństwo</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">sim</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">hds</span> : <span class="id" title="var">hd</span> <span class="id" title="var">s1</span> = <span class="id" title="var">hd</span> <span class="id" title="var">s2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tls</span> : <span class="id" title="var">sim</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">tl</span> <span class="id" title="var">s2</span>);<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_refl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_sym</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s1</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_trans</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">s3</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s3</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s3</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Setoid</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>]<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Equiv_sim</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">Equivalence</span> (@<span class="id" title="var">sim</span> <span class="id" title="var">A</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab667"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">sapp</span></span></h1>

<div class="paragraph"> </div>

 Zdefiniuj funkcję <span class="inlinecode"><span class="id" title="var">sapp</span></span>, która skleja dwa strumienie. Czy taka
    funkcja w ogóle ma sens?
</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">sapp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> <span class="id" title="var">s1</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">sapp</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s1</span>) <span class="id" title="var">s2</span>;<br/>
|}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sapp_pointless</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">sapp</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) <span class="id" title="var">s1</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab668"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">lsapp</span></span></h1>

<div class="paragraph"> </div>

 Zdefiniuj funkcję <span class="inlinecode"><span class="id" title="var">lsapp</span></span>, która dokleja listę na początek
    strumienia. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a id="lab669"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">map</span></span></h1>

<div class="paragraph"> </div>

 Zdefiniuj funkcję <span class="inlinecode"><span class="id" title="var">map</span></span>, która aplikuje funkcję <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">B</span></span> do
    każdego elementu strumienia. 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_id</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">map</span> (@<span class="id" title="var">id</span> <span class="id" title="var">A</span>) <span class="id" title="var">s</span>) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_map</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">map</span> <span class="id" title="var">g</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)) (<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">s</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab670"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">zipWith</span></span> i <span class="inlinecode"><span class="id" title="var">unzip</span></span> (TODO)</h1>

<div class="paragraph"> </div>

 Zdefiniuj funkcję <span class="inlinecode"><span class="id" title="var">zipWith</span></span>, która ze dwóch strumieni elementów
    <span class="inlinecode"><span class="id" title="var">A</span></span> oraz <span class="inlinecode"><span class="id" title="var">B</span></span> robi strumień elementów <span class="inlinecode"><span class="id" title="var">C</span></span>, mając do dyspozycji
    funkcję <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">B</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span></span> <span class="inlinecode"></span>.

<div class="paragraph"> </div>

    Następnie zdefiniuj funkcję <span class="inlinecode"><span class="id" title="var">unzip</span></span>, która ze strumienia par
    robi parę strumieni wiadomo w jaki sposób.

<div class="paragraph"> </div>

    Czy <span class="inlinecode"><span class="id" title="var">zipWithh</span></span> <span class="inlinecode"><span class="id" title="var">pair</span></span> i <span class="inlinecode"><span class="id" title="var">unzip</span></span> są swoimi odwrotnościami? 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a id="lab671"></a><h1 class="section">Inne funkcje (TODO)</h1>

<div class="paragraph"> </div>

 Zdefiniuj resztę przydatnych funkcji podobnych do tych, które są
    dostępne dla list: <span class="inlinecode"><span class="id" title="tactic">repeat</span></span>, <span class="inlinecode"><span class="id" title="var">iterate</span></span>, <span class="inlinecode"><span class="id" title="var">nth</span></span>, <span class="inlinecode"><span class="id" title="var">take</span></span>, <span class="inlinecode"><span class="id" title="var">drop</span></span>,
    <span class="inlinecode"><span class="id" title="var">splitAt</span></span>, <span class="inlinecode"><span class="id" title="var">insert</span></span>, <span class="inlinecode"><span class="id" title="tactic">replace</span></span>, <span class="inlinecode"><span class="id" title="var">scanl</span></span>, <span class="inlinecode"><span class="id" title="var">scanr</span></span>, <span class="inlinecode"><span class="id" title="var">intersperse</span></span>,
    <span class="inlinecode"><span class="id" title="var">merge</span></span>.

<div class="paragraph"> </div>

    Zdefiniuj też funkcje, których zapomniałem (albo nie chciało mi
    się) wymienić. 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_repeat</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">merge</span> <span class="id" title="var">s</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">intersperse</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;uporządkować&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_map</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">sim</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_diagonal</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> (<span class="id" title="var">Stream</span> <span class="id" title="var">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">sim</span> (<span class="id" title="var">diagonal</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">diagonal</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">take</span> 10 (<span class="id" title="var">diagonal</span> (<span class="id" title="var">map</span> <span class="id" title="var">from</span> (<span class="id" title="var">from</span> 0))).<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">take</span> 10 (<span class="id" title="var">iterate</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) 0).<br/>

<br/>
<span class="comment">(*&nbsp;TODO&nbsp;*)</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">diagonal_from</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">diagonal</span> (<span class="id" title="var">map</span> <span class="id" title="var">from</span> (<span class="id" title="var">from</span> <span class="id" title="var">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iterate</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nth_insert</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nth</span> <span class="id" title="var">n</span> (<span class="id" title="var">insert</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nth_replace</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nth</span> <span class="id" title="var">n</span> (<span class="id" title="tactic">replace</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">drop_map</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">drop</span> <span class="id" title="var">n</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>) = <span class="id" title="var">map</span> <span class="id" title="var">f</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hd_drop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>) = <span class="id" title="var">nth</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tl_drop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>) = <span class="id" title="var">drop</span> <span class="id" title="var">n</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nth_drop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nth</span> <span class="id" title="var">n</span> (<span class="id" title="var">drop</span> <span class="id" title="var">m</span> <span class="id" title="var">s</span>) = <span class="id" title="var">nth</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">drop_drop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">drop</span> <span class="id" title="var">m</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>) = <span class="id" title="var">drop</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;take_map&nbsp;dla&nbsp;strumieni&nbsp;*)</span><br/>
<span class="comment">(*<br/>
Lemma&nbsp;take_map&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;:&nbsp;Type}&nbsp;(f&nbsp;:&nbsp;A&nbsp;-&gt;&nbsp;B)&nbsp;(n&nbsp;:&nbsp;nat)&nbsp;(s&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;take&nbsp;n&nbsp;(map&nbsp;f&nbsp;s)&nbsp;=&nbsp;D5.map&nbsp;f&nbsp;(take&nbsp;n&nbsp;s).<br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;n&nbsp;as&nbsp;<span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">n'</span></span>;&nbsp;cbn;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;reflexivity.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;IHn'.&nbsp;reflexivity.<br/>
Qed.<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab672"></a><h1 class="section">Predykaty i relacje na strumieniach (TODO)</h1>

<div class="paragraph"> </div>

 Zdefiniuj różne użyteczne predykaty i relacje podobne do tych
    listowych, w tym <span class="inlinecode"><span class="id" title="var">Elem</span></span>, <span class="inlinecode"><span class="id" title="var">Dup</span></span>, <span class="inlinecode"><span class="id" title="var">NoDup</span></span>, <span class="inlinecode"><span class="id" title="var">Exists</span></span>, <span class="inlinecode"><span class="id" title="var">Forall</span></span> i
    wszystkie inne, o których zapomniałem. 
</div>
<div class="code">

<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Constructors</span> <span class="id" title="var">Elem</span> : <span class="id" title="var">core</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Arith</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elem_nth</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Elem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">nth</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span> = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nth_from</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nth</span> <span class="id" title="var">n</span> (<span class="id" title="var">from</span> <span class="id" title="var">m</span>) = <span class="id" title="var">n</span> + <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elem_from_add</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Elem</span> <span class="id" title="var">n</span> (<span class="id" title="var">from</span> <span class="id" title="var">m</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">Elem</span> (<span class="id" title="var">k</span> + <span class="id" title="var">n</span>) (<span class="id" title="var">from</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elem_from</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Elem</span> <span class="id" title="var">n</span> (<span class="id" title="var">from</span> <span class="id" title="var">m</span>) &lt;-&gt; <span class="id" title="var">m</span> &lt;= <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Dup_spec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Dup</span> <span class="id" title="var">s</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">n</span> &lt;&gt; <span class="id" title="var">m</span> /\ <span class="id" title="var">nth</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span> = <span class="id" title="var">nth</span> <span class="id" title="var">m</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">NoDup_from</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id" title="var">Dup</span> (<span class="id" title="var">from</span> <span class="id" title="var">n</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Exists_spec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Exists</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">nth</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_spec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall</span> <span class="id" title="var">s</span> <span class="id" title="var">P</span> &lt;-&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">nth</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_spec'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall</span> <span class="id" title="var">s</span> <span class="id" title="var">P</span> &lt;-&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">Elem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_Exists</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall</span> <span class="id" title="var">s</span> <span class="id" title="var">P</span> -&gt; <span class="id" title="var">Exists</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="comment">(*<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;[projections(primitive = no)] *)</span><br/>
Variant&nbsp;SubstreamF&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(F&nbsp;:&nbsp;Stream&nbsp;A&nbsp;-&gt;&nbsp;Stream&nbsp;A&nbsp;-&gt;&nbsp;Prop)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A)&nbsp;:&nbsp;Prop&nbsp;:=<br/>
|&nbsp;MkSubstreamF&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;n&nbsp;:&nbsp;nat,&nbsp;hd&nbsp;s1&nbsp;=&nbsp;nth&nbsp;n&nbsp;s2&nbsp;-&gt;&nbsp;F&nbsp;(tl&nbsp;s1)&nbsp;(drop&nbsp;(S&nbsp;n)&nbsp;s2)&nbsp;-&gt;&nbsp;SubstreamF&nbsp;F&nbsp;s1&nbsp;s2.<br/>
<span class="comment">(*<br/>
{<br/>
&nbsp;&nbsp;pos&nbsp;:&nbsp;nat;<br/>
&nbsp;&nbsp;nth_pos_hd&nbsp;:&nbsp;hd&nbsp;s1&nbsp;=&nbsp;nth&nbsp;pos&nbsp;s2;<br/>
&nbsp;&nbsp;SubstreamT'&nbsp;:&nbsp;F&nbsp;(tl&nbsp;s1)&nbsp;(drop&nbsp;(S&nbsp;pos)&nbsp;s2);<br/>
}.<br/>
*)</span><br/>
<br/>
CoInductive&nbsp;Substream&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A)&nbsp;:&nbsp;Prop&nbsp;:=<br/>
{<br/>
&nbsp;&nbsp;Substream_out&nbsp;:&nbsp;SubstreamT&nbsp;Substream&nbsp;s1&nbsp;s2;<br/>
}.<br/>
<br/>
CoInductive&nbsp;SubstreamT&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A)&nbsp;:&nbsp;Type&nbsp;:=<br/>
{<br/>
&nbsp;&nbsp;pos&nbsp;:&nbsp;nat;<br/>
&nbsp;&nbsp;nth_pos_hd&nbsp;:&nbsp;hd&nbsp;s1&nbsp;=&nbsp;nth&nbsp;pos&nbsp;s2;<br/>
&nbsp;&nbsp;SubstreamT'&nbsp;:&nbsp;SubstreamT&nbsp;(tl&nbsp;s1)&nbsp;(drop&nbsp;(S&nbsp;pos)&nbsp;s2);<br/>
}.<br/>
<br/>
Definition&nbsp;Substream&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A)&nbsp;:&nbsp;Prop&nbsp;:=<br/>
&nbsp;&nbsp;inhabited&nbsp;(SubstreamT&nbsp;s1&nbsp;s2).<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;drop_tl&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(n&nbsp;:&nbsp;nat)&nbsp;(s&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;drop&nbsp;n&nbsp;(tl&nbsp;s)&nbsp;=&nbsp;drop&nbsp;(S&nbsp;n)&nbsp;s.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;reflexivity.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_tl&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;-&gt;&nbsp;Substream&nbsp;(tl&nbsp;s1)&nbsp;(tl&nbsp;s2).<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;s1&nbsp;s2&nbsp;<span class="inlinecode">[<span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">[<span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode"><span class="id" title="var">H</span>]]</span>.<br/>
&nbsp;&nbsp;rewrite&nbsp;nth_drop,&nbsp;&lt;-&nbsp;plus_n_Sm&nbsp;in&nbsp;q.<br/>
&nbsp;&nbsp;constructor;&nbsp;econstructor;&nbsp;<span class="inlinecode"><span class="id" title="var">now</span></span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;now&nbsp;rewrite&nbsp;drop_drop,&nbsp;&lt;-&nbsp;plus_n_Sm,&nbsp;plus_Sn_m,&nbsp;Nat.add_comm&nbsp;in&nbsp;H.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_tl_l&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;-&gt;&nbsp;Substream&nbsp;(tl&nbsp;s1)&nbsp;s2.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;s1&nbsp;s2&nbsp;<span class="inlinecode">[<span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">[<span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">q</span></span> <span class="inlinecode"><span class="id" title="var">H</span>]]</span>.<br/>
&nbsp;&nbsp;constructor;&nbsp;econstructor.<br/>
&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;q,&nbsp;nth_drop.<br/>
&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;drop_drop,&nbsp;Nat.add_comm,&nbsp;plus_Sn_m&nbsp;in&nbsp;H.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_drop&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(n&nbsp;:&nbsp;nat)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;-&gt;&nbsp;Substream&nbsp;(drop&nbsp;n&nbsp;s1)&nbsp;(drop&nbsp;n&nbsp;s2).<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;n&nbsp;as&nbsp;<span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">n'</span></span>;&nbsp;cbn;&nbsp;intros;&nbsp;<span class="inlinecode"><span class="id" title="var">easy</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;now&nbsp;apply&nbsp;IHn',&nbsp;Substream_tl.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_drop_l&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(n&nbsp;:&nbsp;nat)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;-&gt;&nbsp;Substream&nbsp;(drop&nbsp;n&nbsp;s1)&nbsp;s2.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;n&nbsp;as&nbsp;<span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">n'</span></span>;&nbsp;cbn;&nbsp;intros;&nbsp;<span class="inlinecode"><span class="id" title="var">easy</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;now&nbsp;apply&nbsp;IHn',&nbsp;Substream_tl_l.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_refl&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(s&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s&nbsp;s.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;constructor;&nbsp;revert&nbsp;s.<br/>
&nbsp;&nbsp;cofix&nbsp;CH.<br/>
&nbsp;&nbsp;econstructor&nbsp;1&nbsp;with&nbsp;(pos&nbsp;:=&nbsp;0);&nbsp;cbn;&nbsp;<span class="inlinecode"><span class="id" title="var">easy</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;now&nbsp;apply&nbsp;CH.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_trans&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(s1&nbsp;s2&nbsp;s3&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;-&gt;&nbsp;Substream&nbsp;s2&nbsp;s3&nbsp;-&gt;&nbsp;Substream&nbsp;s1&nbsp;s3.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;s1&nbsp;s2&nbsp;s3&nbsp;<span class="inlinecode"><span class="id" title="var">H12</span></span>&nbsp;H23;&nbsp;constructor;&nbsp;revert&nbsp;s1&nbsp;s2&nbsp;s3&nbsp;H12&nbsp;H23.<br/>
&nbsp;&nbsp;cofix&nbsp;CH.<br/>
&nbsp;&nbsp;intros&nbsp;s1&nbsp;s2&nbsp;s3&nbsp;<span class="inlinecode"><span class="id" title="var">n1</span></span> <span class="inlinecode"><span class="id" title="var">p1</span></span> <span class="inlinecode"><span class="id" title="var">H12'</span></span>&nbsp;H23.<br/>
&nbsp;&nbsp;destruct&nbsp;(Substream_drop&nbsp;_&nbsp;n1&nbsp;_&nbsp;_&nbsp;H23)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">n2</span></span> <span class="inlinecode"><span class="id" title="var">p2</span></span> <span class="inlinecode"><span class="id" title="var">H2</span></span>.<br/>
&nbsp;&nbsp;econstructor&nbsp;1&nbsp;with&nbsp;(n&nbsp;:=&nbsp;n1&nbsp;+&nbsp;n2);&nbsp;cbn.<br/>
&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;Nat.add_comm,&nbsp;&lt;-&nbsp;nth_drop,&nbsp;&lt;-&nbsp;p2,&nbsp;hd_drop.<br/>
&nbsp;&nbsp;-&nbsp;apply&nbsp;CH&nbsp;with&nbsp;(tl&nbsp;(drop&nbsp;n1&nbsp;s2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;now&nbsp;rewrite&nbsp;tl_drop.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;now&nbsp;rewrite&nbsp;drop_tl,&nbsp;plus_n_Sm,&nbsp;&lt;-&nbsp;drop_drop.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Substream_not_antisymm&nbsp;:<br/>
&nbsp;&nbsp;exists&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(s1&nbsp;s2&nbsp;:&nbsp;Stream&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Substream&nbsp;s1&nbsp;s2&nbsp;/\&nbsp;Substream&nbsp;s2&nbsp;s1&nbsp;/\&nbsp;~&nbsp;sim&nbsp;s1&nbsp;s2.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;exists&nbsp;bool,&nbsp;(iterate&nbsp;negb&nbsp;true),&nbsp;(iterate&nbsp;negb&nbsp;false).<br/>
&nbsp;&nbsp;repeat&nbsp;split.<br/>
&nbsp;&nbsp;-&nbsp;econstructor&nbsp;1&nbsp;with&nbsp;(n&nbsp;:=&nbsp;1);&nbsp;cbn;&nbsp;<span class="inlinecode"><span class="id" title="var">easy</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;apply&nbsp;Substream_refl.<br/>
&nbsp;&nbsp;-&nbsp;econstructor&nbsp;1&nbsp;with&nbsp;(n&nbsp;:=&nbsp;1);&nbsp;cbn;&nbsp;<span class="inlinecode"><span class="id" title="var">easy</span></span> <span class="inlinecode">|</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;apply&nbsp;Substream_refl.<br/>
&nbsp;&nbsp;-&nbsp;intros&nbsp;<span class="inlinecode">[=]</span> <span class="inlinecode"><span class="id" title="var">tls</span></span>.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
*)</span><br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">snoc</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">nil</span> =&gt; <span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">nil</span><br/>
| <span class="id" title="var">cons</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">cons</span> <span class="id" title="var">h</span> (<span class="id" title="var">snoc</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Suffix_spec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Suffix</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">s2</span> = <span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s1</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_Elem</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">Elem</span> <span class="id" title="var">x</span> <span class="id" title="var">s1</span> -&gt; <span class="id" title="var">Elem</span> <span class="id" title="var">x</span> <span class="id" title="var">s2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_Incl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s1'</span> <span class="id" title="var">s2</span> <span class="id" title="var">s2'</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s1'</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s2'</span> -&gt; <span class="id" title="var">Incl</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">Incl</span> <span class="id" title="var">s1'</span> <span class="id" title="var">s2'</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sim_SetEquiv</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s1'</span> <span class="id" title="var">s2</span> <span class="id" title="var">s2'</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s1'</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s2'</span> -&gt; <span class="id" title="var">SetEquiv</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">SetEquiv</span> <span class="id" title="var">s1'</span> <span class="id" title="var">s2'</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">scons</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">s</span>;<br/>
|}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab673"></a><h1 class="section">Permutacje strumieni</h1>

<div class="paragraph"> </div>

 Zdefiniuj relację <span class="inlinecode"><span class="id" title="var">SPermutation</span></span>, która jest analogiczna do
    relacji <span class="inlinecode"><span class="id" title="var">Permutation</span></span>, którą znasz z list. Udowodnij jej
    specyfikację. 
</div>
<div class="code">

<br/>

<br/>
<span class="comment">(*&nbsp;TODO&nbsp;*)</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Permutation</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lsapp_scons</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lsapp</span> <span class="id" title="var">l</span> (<span class="id" title="var">scons</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) = <span class="id" title="var">lsapp</span> (<span class="id" title="var">snoc</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">SPermutation_Permutation_lsapp</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Permutation</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">SPermutation</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SPermutation</span> (<span class="id" title="var">lsapp</span> <span class="id" title="var">l1</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">lsapp</span> <span class="id" title="var">l2</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">take_drop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s</span> (<span class="id" title="var">lsapp</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>) (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">take_add</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">take</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) <span class="id" title="var">s</span> = <span class="id" title="var">List.app</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>) (<span class="id" title="var">take</span> <span class="id" title="var">m</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">SPermutation_spec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SPermutation</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Permutation</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">s2</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s1</span> = <span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">s2</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab674"></a><h1 class="section">Permutacje strumieni v2</h1>

<div class="paragraph"> </div>

 Poprzedni podrozdział jest trochę lipny, bo tamtejsza definicja nie uchwytuje wszystkich możliwych
    permutacji strumieni - wymusza ona, żeby każda permutacja składa się z jedynie skończonej liczby
    przestawień. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">swap</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> <span class="id" title="var">s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">swap</span> (<span class="id" title="var">tl</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>));<br/>
&nbsp;&nbsp;|}<br/>
|}.<br/>

<br/>
</div>

<div class="doc">
Widać, że dla strumienia pokroju <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">cocons</span></span> <span class="inlinecode">0</span> <span class="inlinecode">(<span class="id" title="var">cocons</span></span> <span class="inlinecode">1</span> <span class="inlinecode">(<span class="id" title="var">cocons</span></span> <span class="inlinecode">2</span> <span class="inlinecode">...))</span> zdanie
    <span class="inlinecode"><span class="id" title="var">SPermutation</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">(<span class="id" title="var">swap</span></span> <span class="inlinecode"><span class="id" title="var">s</span>)</span> nie zachodzi, bo przestawienia elementów ciągną się w
    nieskończoność.

<div class="paragraph"> </div>

    Potrzebna jest nam zatem jakaś lepsza definicja permutacji. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">SPermutation_not_swap</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SPermutation</span> <span class="id" title="var">s</span> (<span class="id" title="var">swap</span> <span class="id" title="var">s</span>) -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s</span> (<span class="id" title="var">swap</span> <span class="id" title="var">s</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab675"></a><h1 class="section">Strumienie za pomocą przybliżeń (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Program.Equality</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">approx</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Vec</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">vnil</span> : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> 0<br/>
| <span class="id" title="var">vcons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">vnil</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">vcons</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">n</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">vhd</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) : <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">v</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">vcons</span> <span class="id" title="var">h</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">h</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">vtl</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">v</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">vcons</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">t</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vhd_vtl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">v</span> = <span class="id" title="var">vcons</span> (<span class="id" title="var">vhd</span> <span class="id" title="var">v</span>) (<span class="id" title="var">vtl</span> <span class="id" title="var">v</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">vtake</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
| 0 =&gt; <span class="id" title="var">vnil</span><br/>
| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">vcons</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) (<span class="id" title="var">vtake</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) <span class="id" title="var">n'</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">vtake'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
| 0 =&gt; <span class="id" title="var">vcons</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) <span class="id" title="var">vnil</span><br/>
| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">vcons</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) (<span class="id" title="var">vtake'</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) <span class="id" title="var">n'</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">unvtake</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">vhd</span> (<span class="id" title="var">f</span> 0);<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">unvtake</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">vtl</span> (<span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)))<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">vnth</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">option</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">v</span>, <span class="id" title="var">k</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">vnil</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
| <span class="id" title="var">vcons</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span>, 0 =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">h</span><br/>
| <span class="id" title="var">vcons</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span>, <span class="id" title="var">S</span> <span class="id" title="var">k'</span> =&gt; <span class="id" title="var">vnth</span> <span class="id" title="var">t</span> <span class="id" title="var">k'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">depdestr</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x'</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span> <span class="id" title="var">remember</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x'</span>; <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">x'</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unvtake_vtake'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">f</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">Vec</span> <span class="id" title="var">A</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">k</span> &lt;= <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">k</span> &lt;= <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vnth</span> (<span class="id" title="var">f</span> <span class="id" title="var">m1</span>) <span class="id" title="var">k</span> = <span class="id" title="var">vnth</span> (<span class="id" title="var">f</span> <span class="id" title="var">m2</span>) <span class="id" title="var">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vtake'</span> (<span class="id" title="var">unvtake</span> <span class="id" title="var">f</span>) <span class="id" title="var">n</span> = <span class="id" title="var">f</span> <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vtake_unvtake</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">unvtake</span> (<span class="id" title="var">vtake'</span> <span class="id" title="var">s</span>)) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">approx</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab676"></a><h1 class="section">Pomysł dawno zapomniany: (ko)induktywne specyfikacje funkcji (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Filter</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">bool</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">Filter_true</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">Filter</span> <span class="id" title="var">f</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> <span class="id" title="var">r'</span> = <span class="id" title="var">hd</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">tl</span> <span class="id" title="var">r'</span> = <span class="id" title="var">r</span> -&gt; <span class="id" title="var">Filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">r'</span><br/>
| <span class="id" title="var">Filter_false</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">r</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) = <span class="id" title="var">false</span> -&gt; <span class="id" title="var">Filter</span> <span class="id" title="var">f</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) <span class="id" title="var">r</span> -&gt; <span class="id" title="var">Filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Filter_bad</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">bool</span>) (<span class="id" title="var">s</span> <span class="id" title="var">r</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">r</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">false</span>) -&gt; <span class="id" title="var">False</span>.<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Filter'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">bool</span>) (<span class="id" title="var">s</span> <span class="id" title="var">r</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">Filter'_true</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">hd</span> <span class="id" title="var">s</span> = <span class="id" title="var">hd</span> <span class="id" title="var">r</span> /\ <span class="id" title="var">Filter'</span> <span class="id" title="var">f</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) (<span class="id" title="var">tl</span> <span class="id" title="var">r</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">Filter'_false</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>) = <span class="id" title="var">false</span> -&gt; <span class="id" title="var">Filter'</span> <span class="id" title="var">f</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>) <span class="id" title="var">r</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Filter'_const_false</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> <span class="id" title="var">r</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Filter'</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span>) <span class="id" title="var">s</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Filter'_const_true</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> <span class="id" title="var">r</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Filter'</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span>) <span class="id" title="var">s</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">sim</span> <span class="id" title="var">s</span> <span class="id" title="var">r</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab677"></a><h1 class="section">Bijekcja między <span class="inlinecode"><span class="id" title="var">Stream</span></span> <span class="inlinecode"><span class="id" title="var">unit</span></span> i <span class="inlinecode"><span class="id" title="var">unit</span></span> (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FinFun</span> <span class="id" title="var">ZArith</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">theChosenOne</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">tt</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">theChosenOne</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_chosen_unit_aux</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">s</span> <span class="id" title="var">theChosenOne</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_chosen_unit</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">sim_eq</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>), <span class="id" title="var">sim</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_eq</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unit_to_stream</span> (<span class="id" title="var">u</span> : <span class="id" title="var">unit</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span> := <span class="id" title="var">theChosenOne</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stream_to_unit</span> (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>) : <span class="id" title="var">unit</span> := <span class="id" title="var">tt</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unit_is_Stream_unit</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Bijective</span> <span class="id" title="var">unit_to_stream</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab678"></a><h1 class="section">Trochę losowości (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">rand</span> (<span class="id" title="var">seed</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <span class="id" title="var">Z</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">Z</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">rand</span> (<span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span> * <span class="id" title="var">n1</span>) <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">rand'</span> (<span class="id" title="var">seed</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <span class="id" title="var">Z</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">Z</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">rand'</span> (<span class="id" title="var">Zmod</span> (<span class="id" title="var">seed</span> * <span class="id" title="var">n1</span>) <span class="id" title="var">n2</span>) <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>;<br/>
|}.<br/>
</div>
