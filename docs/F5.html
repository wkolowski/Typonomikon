<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-3.5.1.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
<title>Typonomikon</title>
</head>
<h1 class="libtitle">F5: Kodrzewa [TODO]</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab868"></a><h1 class="section">Drzewa nieskończone (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">InfTree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">root</span>  {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="tactic">left</span>  {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="tactic">right</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab869"></a><h2 class="section">Korekursja i koindukcja na drzewach nieskończonych (TODO)</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">corecursive</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">rt</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">root_f</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">root</span>  (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">rt</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">left_f</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="tactic">left</span>  (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">l</span> <span class="id" title="var">x</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">right_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="tactic">right</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">r</span> <span class="id" title="var">x</span>);<br/>
}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">corec</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">rt</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">rt</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">corec</span> <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> (<span class="id" title="var">l</span> <span class="id" title="var">x</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">corec</span> <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> (<span class="id" title="var">r</span> <span class="id" title="var">x</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">corecursive_corec</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">rt</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">corecursive</span> (<span class="id" title="var">corec</span> <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">uniqueness</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rt</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">corecursive</span> <span class="id" title="var">f</span> <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">corecursive</span> <span class="id" title="var">g</span> <span class="id" title="var">rt</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">sim</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">roots</span> : <span class="id" title="var">root</span> <span class="id" title="var">t1</span> = <span class="id" title="var">root</span> <span class="id" title="var">t2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">lefts</span> : <span class="id" title="var">sim</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t1</span>) (<span class="id" title="tactic">left</span> <span class="id" title="var">t2</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">rights</span> : <span class="id" title="var">sim</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t1</span>) (<span class="id" title="tactic">right</span> <span class="id" title="var">t2</span>);<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sim_to_eq</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>, <span class="id" title="var">sim</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">t1</span> = <span class="id" title="var">t2</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Index</span> : <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">here</span> : <span class="id" title="var">Index</span><br/>
| <span class="id" title="var">goleft</span> : <span class="id" title="var">Index</span> -&gt; <span class="id" title="var">Index</span><br/>
| <span class="id" title="var">goright</span> : <span class="id" title="var">Index</span> -&gt; <span class="id" title="var">Index</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">subtree</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">t</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">subtree</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>) <span class="id" title="var">i'</span><br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">subtree</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>) <span class="id" title="var">i'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">goleft'</span> (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) : <span class="id" title="var">Index</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">goleft</span> <span class="id" title="var">here</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goleft</span> (<span class="id" title="var">goleft'</span> <span class="id" title="var">i'</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goright</span> (<span class="id" title="var">goleft'</span> <span class="id" title="var">i'</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">goright'</span> (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) : <span class="id" title="var">Index</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">goright</span> <span class="id" title="var">here</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goleft</span> (<span class="id" title="var">goright'</span> <span class="id" title="var">i'</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goright</span> (<span class="id" title="var">goright'</span> <span class="id" title="var">i'</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">left_subtree</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> (<span class="id" title="var">subtree</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span>) = <span class="id" title="var">subtree</span> <span class="id" title="var">t</span> (<span class="id" title="var">goleft'</span> <span class="id" title="var">i</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">right_subtree</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span> (<span class="id" title="var">subtree</span> <span class="id" title="var">t</span> <span class="id" title="var">i</span>) = <span class="id" title="var">subtree</span> <span class="id" title="var">t</span> (<span class="id" title="var">goright'</span> <span class="id" title="var">i</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">left_subtree</span> <span class="id" title="var">right_subtree</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">coinduction</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniqueness</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">sim_to_eq</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">uniqueness</span>, <span class="id" title="var">sim_to_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">uniqueness</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">Hsim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span><br/>
&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniqueness</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Index</span>) (<span class="id" title="var">subtree</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subtree</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">root</span> (<span class="id" title="var">subtree</span> <span class="id" title="var">t2</span> <span class="id" title="var">i</span>)) <span class="id" title="var">goleft'</span> <span class="id" title="var">goright'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">here</span><br/>
&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">uniqueness</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">Hsim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">IHi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">IHi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">tsim</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">lt</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">rt</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">tsim'</span> : <span class="id" title="var">sim</span> <span class="id" title="var">lt</span> <span class="id" title="var">rt</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">lt</span>    {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">rt</span>    {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">tsim'</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">root'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">tsim</span> <span class="id" title="var">A</span>) : <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> (<span class="id" title="var">rt</span> <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">left'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">tsim</span> <span class="id" title="var">A</span>) : <span class="id" title="var">tsim</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">lt</span> := <span class="id" title="tactic">left</span> (<span class="id" title="var">lt</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">rt</span> := <span class="id" title="tactic">left</span> (<span class="id" title="var">rt</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">tsim'</span> := <span class="id" title="var">lefts</span> (<span class="id" title="var">tsim'</span> <span class="id" title="var">t</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">right'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">tsim</span> <span class="id" title="var">A</span>) : <span class="id" title="var">tsim</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">lt</span> := <span class="id" title="tactic">right</span> (<span class="id" title="var">lt</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">rt</span> := <span class="id" title="tactic">right</span> (<span class="id" title="var">rt</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">tsim'</span> := <span class="id" title="var">rights</span> (<span class="id" title="var">tsim'</span> <span class="id" title="var">t</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">coinduction'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniqueness</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">sim_to_eq</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">uniqueness</span>, <span class="id" title="var">sim_to_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">uniqueness</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">Hsim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span><br/>
&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniqueness</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tsim</span> <span class="id" title="var">A</span>) <span class="id" title="var">lt</span> <span class="id" title="var">rt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root'</span> <span class="id" title="var">left'</span> <span class="id" title="var">right'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id" title="var">lt</span> := <span class="id" title="var">t1</span>; <span class="id" title="var">rt</span> := <span class="id" title="var">t2</span>; <span class="id" title="var">tsim'</span> := <span class="id" title="var">Hsim</span> |}<br/>
&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>, <span class="id" title="var">tsim'0</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">root'</span>; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab870"></a><h2 class="section">Funkcje na drzewach nieskończonych</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Typonomikon</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">D5</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">mirror</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">root</span> <span class="id" title="var">t</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">mirror</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">mirror</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mirror_mirror</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">mirror</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">t</span>)) <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">tmap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">B</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">f</span> (<span class="id" title="var">root</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">tmap</span> <span class="id" title="var">f</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">tmap</span> <span class="id" title="var">f</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tmap_id</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">tmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span>) <span class="id" title="var">t</span>) <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tmap_comp</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">tmap</span> <span class="id" title="var">g</span> (<span class="id" title="var">tmap</span> <span class="id" title="var">f</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">tmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">t</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">replicate</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">replicate</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">replicate</span> <span class="id" title="var">x</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">index</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">root</span> <span class="id" title="var">t</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">index</span> <span class="id" title="var">i'</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">index</span> <span class="id" title="var">i'</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">revi</span> (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) : <span class="id" title="var">Index</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">here</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goright</span> (<span class="id" title="var">revi</span> <span class="id" title="var">i'</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">goleft</span> (<span class="id" title="var">revi</span> <span class="id" title="var">i'</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">index_mirror</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> <span class="id" title="var">i</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">t</span>) = <span class="id" title="var">index</span> (<span class="id" title="var">revi</span> <span class="id" title="var">i</span>) <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">i'</span> | <span class="id" title="var">i'</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">node</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> <span class="id" title="var">r</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">v</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">l</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">r</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="tactic">replace</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">node</span> <span class="id" title="var">x</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">node</span> (<span class="id" title="var">root</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">replace</span> <span class="id" title="var">i'</span> <span class="id" title="var">x</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>)) (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">node</span> (<span class="id" title="var">root</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">left</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">replace</span> <span class="id" title="var">i'</span> <span class="id" title="var">x</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t</span>))<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">index_replicate</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> <span class="id" title="var">i</span> (<span class="id" title="var">replicate</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">i'</span> | <span class="id" title="var">i'</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">index_replace</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> <span class="id" title="var">i</span> (<span class="id" title="tactic">replace</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>) = <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">i'</span> | <span class="id" title="var">i'</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">zipW</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">ta</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) (<span class="id" title="var">tb</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">B</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">C</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">f</span> (<span class="id" title="var">root</span> <span class="id" title="var">ta</span>) (<span class="id" title="var">root</span> <span class="id" title="var">tb</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span> := <span class="id" title="var">zipW</span> <span class="id" title="var">f</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">ta</span>) (<span class="id" title="tactic">left</span> <span class="id" title="var">tb</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">zipW</span> <span class="id" title="var">f</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">ta</span>) (<span class="id" title="tactic">right</span> <span class="id" title="var">tb</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">zipW_mirror</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ta</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) (<span class="id" title="var">tb</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sim</span> (<span class="id" title="var">zipW</span> <span class="id" title="var">f</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">ta</span>) (<span class="id" title="var">mirror</span> <span class="id" title="var">tb</span>)) (<span class="id" title="var">mirror</span> (<span class="id" title="var">zipW</span> <span class="id" title="var">f</span> <span class="id" title="var">ta</span> <span class="id" title="var">tb</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unzipW</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span> * <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">t</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">C</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> * <span class="id" title="var">InfTree</span> <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">fst</span> (<span class="id" title="var">f</span> <span class="id" title="var">c</span>)) <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">snd</span> (<span class="id" title="var">f</span> <span class="id" title="var">c</span>)) <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">replace'</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">t2</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">node</span> (<span class="id" title="var">root</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">replace'</span> <span class="id" title="var">i'</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t1</span>) <span class="id" title="var">t2</span>) (<span class="id" title="tactic">right</span> <span class="id" title="var">t1</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">node</span> (<span class="id" title="var">root</span> <span class="id" title="var">t1</span>) (<span class="id" title="tactic">left</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">replace'</span> <span class="id" title="var">i'</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t1</span>) <span class="id" title="var">t2</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subtree_replace'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">subtree</span> (<span class="id" title="var">replace'</span> <span class="id" title="var">i</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) <span class="id" title="var">i</span> = <span class="id" title="var">t2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">i'</span> | <span class="id" title="var">i'</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHi'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">iterate'</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;<span class="id" title="var">root</span>  := <span class="id" title="var">iter</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span>  := <span class="id" title="var">iterate'</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (1 + 2 * <span class="id" title="var">n</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span> := <span class="id" title="var">iterate'</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (2 + 2 * <span class="id" title="var">n</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">index_to_nat'</span> (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">nat</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
| <span class="id" title="var">here</span> =&gt; <span class="id" title="var">n</span><br/>
| <span class="id" title="var">goleft</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">index_to_nat'</span> <span class="id" title="var">i'</span> (1 + 2 * <span class="id" title="var">n</span>)<br/>
| <span class="id" title="var">goright</span> <span class="id" title="var">i'</span> =&gt; <span class="id" title="var">index_to_nat'</span> <span class="id" title="var">i'</span> (2 + 2 * <span class="id" title="var">n</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">index_iterate'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> <span class="id" title="var">i</span> (<span class="id" title="var">iterate'</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) = <span class="id" title="var">iter</span> <span class="id" title="var">f</span> (<span class="id" title="var">index_to_nat'</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">i'</span> | <span class="id" title="var">i'</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHi'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iterate</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iterate'</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> 0.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">index_to_nat</span> (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">index_to_nat'</span> <span class="id" title="var">i</span> 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">index_iterate</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">Index</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> <span class="id" title="var">i</span> (<span class="id" title="var">iterate</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">iter</span> <span class="id" title="var">f</span> (<span class="id" title="var">index_to_nat</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">index_iterate'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">InfTreeNeq</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">ITN_root</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t1</span> &lt;&gt; <span class="id" title="var">root</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">InfTreeNeq</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span><br/>
| <span class="id" title="var">ITN_left</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InfTreeNeq</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">t1</span>) (<span class="id" title="tactic">left</span> <span class="id" title="var">t2</span>) -&gt; <span class="id" title="var">InfTreeNeq</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span><br/>
| <span class="id" title="var">ITN_right</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InfTreeNeq</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">t1</span>) (<span class="id" title="tactic">right</span> <span class="id" title="var">t2</span>) -&gt; <span class="id" title="var">InfTreeNeq</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InfTreeNeq_neq</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">InfTree</span> <span class="id" title="var">A</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InfTreeNeq</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">t1</span> &lt;&gt; <span class="id" title="var">t2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">intros</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
