<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-3.5.1.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
<title>Typonomikon</title>
</head>
<h1 class="libtitle">H4: Translacja dobrze ufundowana [TODO]</h1>

<div class="code">
</div>

<div class="doc">

<div class="paragraph"> </div>

<a id="lab999"></a><h1 class="section">Domknięcie przechodnie (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">prelude</span> <span class="id" title="var">well_founded</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_tc</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">wf</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="keyword">wf</span> (<span class="id" title="var">tc</span> <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hwf</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hwf</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">Hy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHHy</span>; [| | <span class="id" title="tactic">constructor</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Fail</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Equality</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">step</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">step'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">step</span> <span class="id" title="var">n</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_step</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">wf</span> <span class="id" title="var">step</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n'</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_tc_step</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">wf</span> (<span class="id" title="var">tc</span> <span class="id" title="var">step</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wf_tc</span>, <span class="id" title="var">wf_step</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Fail</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1000"></a><h1 class="section">Podtermy (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Relations</span> <span class="id" title="var">Equality</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Relations.Relation_Operators</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ITree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">ILeaf</span> | <span class="id" title="var">INode</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">ITree</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">ILeaf</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">INode</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">itree_child</span> <span class="id" title="var">A</span> : <span class="id" title="var">ITree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">ITree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">ichild_at</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">f</span> : <span class="id" title="var">itree_child</span> <span class="id" title="var">A</span> (<span class="id" title="var">f</span> <span class="id" title="var">n</span>) (<span class="id" title="var">INode</span> <span class="id" title="var">a</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tree_child_wf</span> <span class="id" title="var">A</span> : <span class="id" title="var">well_founded</span> (<span class="id" title="var">itree_child</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Subterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">ITree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">ITree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">clos_trans_n1</span> <span class="id" title="var">_</span> (@<span class="id" title="var">itree_child</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_Subterm_aux</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">ITree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Subterm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">Acc</span> <span class="id" title="var">Subterm</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">Acc</span> <span class="id" title="var">Subterm</span> <span class="id" title="var">t1</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 2.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_Subterm</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_founded</span> (@<span class="id" title="var">Subterm</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">f</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">wf_Subterm_aux</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1001"></a><h1 class="section">Translacja dobrze ufundowana (TODO)</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Relations</span> <span class="id" title="var">Equality</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Relations.Relation_Operators</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">well_founded_smaller</span> : <span class="id" title="var">well_founded</span> <span class="id" title="var">smaller</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">smaller</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">well_founded_smaller</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span>}.<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_False</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">False</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">False</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> [].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_unit</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">unit</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">False</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> [].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">smaller_bool</span> : <span class="id" title="var">bool</span> -&gt; <span class="id" title="var">bool</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">smaller_false_true</span> : <span class="id" title="var">smaller_bool</span> <span class="id" title="var">false</span> <span class="id" title="var">true</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_bool</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">bool</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="var">smaller_bool</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">smaller_sum</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">RA</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">RB</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">A</span> + <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> + <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">smaller_sum_l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">A</span>), <span class="id" title="var">RA</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> -&gt; <span class="id" title="var">smaller_sum</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">inl</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">inl</span> <span class="id" title="var">a2</span>)<br/>
| <span class="id" title="var">smaller_sum_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">B</span>), <span class="id" title="var">RB</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> -&gt; <span class="id" title="var">smaller_sum</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">inr</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">inr</span> <span class="id" title="var">b2</span>).<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_sum</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">WA</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">A</span>} {<span class="id" title="var">WB</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">B</span>} : <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">A</span> + <span class="id" title="var">B</span>) :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="var">smaller_sum</span> <span class="id" title="var">smaller</span> <span class="id" title="var">smaller</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> | <span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_a</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_b</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Tym razem lewy sumand mniejszy od prawego. 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">smaller_sum'</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">RA</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">RB</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">A</span> + <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> + <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">smaller_sum'_l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">A</span>), <span class="id" title="var">RA</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> -&gt; <span class="id" title="var">smaller_sum'</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">inl</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">inl</span> <span class="id" title="var">a2</span>)<br/>
| <span class="id" title="var">smaller_sum'_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">B</span>), <span class="id" title="var">RB</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> -&gt; <span class="id" title="var">smaller_sum'</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">inr</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">inr</span> <span class="id" title="var">b2</span>)<br/>
| <span class="id" title="var">smaller_sum'_l_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>), <span class="id" title="var">smaller_sum'</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">inl</span> <span class="id" title="var">a</span>) (<span class="id" title="var">inr</span> <span class="id" title="var">b</span>).<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_sum'</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">WA</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">A</span>} {<span class="id" title="var">WB</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">B</span>} : <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">A</span> + <span class="id" title="var">B</span>) :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="var">smaller_sum'</span> <span class="id" title="var">smaller</span> <span class="id" title="var">smaller</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Acc_A</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">Acc</span> (<span class="id" title="var">smaller_sum'</span> <span class="id" title="var">smaller</span> <span class="id" title="var">smaller</span>) (<span class="id" title="var">inl</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_a</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> | <span class="id" title="var">b</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_A</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_b</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_A</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">smaller_prod</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">RA</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">RB</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">A</span> * <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> * <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">smaller_prod_l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>), <span class="id" title="var">RA</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> -&gt; <span class="id" title="var">smaller_prod</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">a1</span>, <span class="id" title="var">b</span>) (<span class="id" title="var">a2</span>, <span class="id" title="var">b</span>)<br/>
| <span class="id" title="var">smaller_prod_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">B</span>), <span class="id" title="var">RB</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> -&gt; <span class="id" title="var">smaller_prod</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> (<span class="id" title="var">a</span>, <span class="id" title="var">b1</span>) (<span class="id" title="var">a</span>, <span class="id" title="var">b2</span>).<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_prod</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">WA</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">A</span>} {<span class="id" title="var">WB</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">B</span>} : <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">A</span> * <span class="id" title="var">B</span>) :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="var">smaller_prod</span> <span class="id" title="var">smaller</span> <span class="id" title="var">smaller</span>;<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_a</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> <span class="id" title="var">Ha</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a'</span> <span class="id" title="var">b'</span>]; <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">Ha</span> <span class="id" title="var">H</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_b</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b'</span> <span class="id" title="var">Hb</span> <span class="id" title="var">IHb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a''</span> <span class="id" title="var">b''</span>]; <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;inna&nbsp;translacja&nbsp;dobrze&nbsp;ufundowana&nbsp;dla&nbsp;produktu<br/>
Inductive&nbsp;smaller_prod'<br/>
&nbsp;&nbsp;{A&nbsp;B&nbsp;:&nbsp;Type}&nbsp;(RA&nbsp;:&nbsp;A&nbsp;-&gt;&nbsp;A&nbsp;-&gt;&nbsp;Prop)&nbsp;(RB&nbsp;:&nbsp;B&nbsp;-&gt;&nbsp;B&nbsp;-&gt;&nbsp;Prop)&nbsp;:&nbsp;A&nbsp;*&nbsp;B&nbsp;-&gt;&nbsp;A&nbsp;*&nbsp;B&nbsp;-&gt;&nbsp;Prop&nbsp;:=<br/>
|&nbsp;smaller_prod'_l&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;(a1&nbsp;a2&nbsp;a3&nbsp;:&nbsp;A)&nbsp;(b1&nbsp;b3&nbsp;:&nbsp;B),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RA&nbsp;a1&nbsp;a2&nbsp;-&gt;&nbsp;smaller_prod'&nbsp;RA&nbsp;RB&nbsp;(a2,&nbsp;b1)&nbsp;(a3,&nbsp;b3)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smaller_prod'&nbsp;RA&nbsp;RB&nbsp;(a1,&nbsp;b1)&nbsp;(a3,&nbsp;b3)<br/>
|&nbsp;smaller_prod'_r&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;(a1&nbsp;a3&nbsp;:&nbsp;A)&nbsp;(b1&nbsp;b2&nbsp;b3&nbsp;:&nbsp;B),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RB&nbsp;b1&nbsp;b2&nbsp;-&gt;&nbsp;smaller_prod'&nbsp;RA&nbsp;RB&nbsp;(a1,&nbsp;b2)&nbsp;(a3,&nbsp;b3)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smaller_prod'&nbsp;RA&nbsp;RB&nbsp;(a1,&nbsp;b1)&nbsp;(a3,&nbsp;b3).<br/>
<br/>
[export, refine] Instance WfTranslation_prod'
  {A B : Type} {WA : WfTranslation A} {WB : WfTranslation B} : WfTranslation (A * B) :=
{
  smaller := smaller_prod' smaller smaller;
}.
Proof.
  intros [a b].
  pose proof (Acc_a := well_founded_smaller a).
  revert b.
  induction Acc_a as [a Ha IHa].
  intros b.
  constructor.
  intros [a' b']; inversion 1; subst.
  - now apply IHa.
  - clear Ha H H1.
    pose proof (Acc_b := well_founded_smaller b').
    revert a IHa; induction Acc_b as [b' Hb IHb].
    constructor.
    intros [a'' b'']; inversion 1; subst.
    + now apply IHa.
    + now apply IHb.
Defined.
*)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">smaller_sigT</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">B</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">RA</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">RB</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">a</span> : <span class="id" title="var">A</span>}, <span class="id" title="var">B</span> <span class="id" title="var">a</span> -&gt; <span class="id" title="var">B</span> <span class="id" title="var">a</span> -&gt; <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">sigT</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="var">sigT</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">smaller_sigT_l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b1</span> : <span class="id" title="var">B</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">b2</span> : <span class="id" title="var">B</span> <span class="id" title="var">a2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">RA</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> -&gt; <span class="id" title="var">smaller_sigT</span> <span class="id" title="var">RA</span> (@<span class="id" title="var">RB</span>) (<span class="id" title="var">existT</span> <span class="id" title="var">a1</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">existT</span> <span class="id" title="var">a2</span> <span class="id" title="var">b2</span>)<br/>
| <span class="id" title="var">smaller_sigT_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">B</span> <span class="id" title="var">a</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">RB</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> -&gt; <span class="id" title="var">smaller_sigT</span> <span class="id" title="var">RA</span> (@<span class="id" title="var">RB</span>) (<span class="id" title="var">existT</span> <span class="id" title="var">a</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">existT</span> <span class="id" title="var">a</span> <span class="id" title="var">b2</span>).<br/>

<br/>
#[<span class="id" title="var">export</span>, <span class="id" title="tactic">refine</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">WfTranslation_sigT</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">B</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">WA</span> : <span class="id" title="var">WfTranslation</span> <span class="id" title="var">A</span>} {<span class="id" title="var">WB</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">B</span> <span class="id" title="var">a</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="var">WfTranslation</span> (<span class="id" title="var">sigT</span> <span class="id" title="var">B</span>) :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">smaller</span> := <span class="id" title="var">smaller_sigT</span> <span class="id" title="var">smaller</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; @<span class="id" title="var">smaller</span> <span class="id" title="var">_</span> (<span class="id" title="var">WB</span> <span class="id" title="var">a</span>));<br/>
}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_a</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> <span class="id" title="var">Ha</span> <span class="id" title="var">IHa</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a'</span> <span class="id" title="var">b'</span>]; <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">Ha</span> <span class="id" title="var">H</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Acc_b</span> := <span class="id" title="var">well_founded_smaller</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">IHa</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">Acc_b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b'</span> <span class="id" title="var">Hb</span> <span class="id" title="var">IHb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a''</span> <span class="id" title="var">b''</span>]; <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb</span>; <span class="id" title="var">only</span> 3: <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">List</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">DirectSubterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">DS_tail</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">h</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>), <span class="id" title="var">DirectSubterm</span> <span class="id" title="var">t</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t</span>).<br/>

<br/>
</div>

<div class="doc">
Domknięcie przechodnie relacji <span class="inlinecode"><span class="id" title="var">DirectSubterm</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Subterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">S_step</span>  : <span class="id" title="keyword">forall</span> {<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>}, <span class="id" title="var">DirectSubterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">Subterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span><br/>
| <span class="id" title="var">S_trans</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>}, <span class="id" title="var">DirectSubterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">Subterm</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> -&gt; <span class="id" title="var">Subterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l3</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_DirectSubterm</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_founded</span> (@<span class="id" title="var">DirectSubterm</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">inversion</span> 1.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">DeepDirectSubterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">DDS_head</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>), <span class="id" title="var">R</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> -&gt; <span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> (<span class="id" title="var">h1</span> :: <span class="id" title="var">t</span>) (<span class="id" title="var">h2</span> :: <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">DDS_tail</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">h</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>), <span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">t</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">DeepSubterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">DS_step</span>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">DeepSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span><br/>
| <span class="id" title="var">DS_trans</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">DeepSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> -&gt; <span class="id" title="var">DeepSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l3</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_DeepDirectSubterm</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_founded</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">well_founded</span> (<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">h</span> <span class="id" title="var">t</span>]; <span class="id" title="tactic">constructor</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1 |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t'</span> <span class="id" title="var">HDS</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">HDS</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">HDS</span>; [| <span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="keyword">wf</span> <span class="id" title="var">h1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t''</span> <span class="id" title="var">HDS</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">HDS</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">HDS</span>; [| <span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">DS_DDS</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DirectSubterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> &lt;-&gt; <span class="id" title="var">DeepDirectSubterm</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">False</span>) <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> []; [| <span class="id" title="tactic">constructor</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">DDS_DS</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DirectSubterm</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l1</span> = <span class="id" title="var">h1</span> :: <span class="id" title="var">t</span>)%<span class="id" title="var">list</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l2</span> = <span class="id" title="var">h2</span> :: <span class="id" title="var">t</span>)%<span class="id" title="var">list</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">right</span>; <span class="id" title="tactic">eauto</span> 7.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [| (<span class="id" title="var">h1</span> &amp; <span class="id" title="var">h2</span> &amp; <span class="id" title="var">t</span> &amp; -&gt; &amp; -&gt; &amp; <span class="id" title="var">r</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">left</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">VeryDeepDirectSubterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">VDDS_head</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> -&gt; <span class="id" title="var">VeryDeepDirectSubterm</span> <span class="id" title="var">R</span> (<span class="id" title="var">h1</span> :: <span class="id" title="var">t</span>) (<span class="id" title="var">h2</span> :: <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">VDDS_tail</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">h</span> : <span class="id" title="var">A</span>) {<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">VeryDeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">VeryDeepDirectSubterm</span> <span class="id" title="var">R</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t1</span>) (<span class="id" title="var">h</span> :: <span class="id" title="var">t2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_VeryDeepDirectSubterm</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_founded</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">well_founded</span> (<span class="id" title="var">VeryDeepDirectSubterm</span> <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">h</span> <span class="id" title="var">t</span>]; <span class="id" title="tactic">constructor</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1 |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t'</span> <span class="id" title="var">VDDS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> <span class="id" title="var">Heql</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">VDDS</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> <span class="id" title="var">t''</span> <span class="id" title="var">r</span> | <span class="id" title="var">h'</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">VDDS</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> [= -&gt; -&gt;] <span class="id" title="var">HAcc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">h</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="keyword">wf</span> <span class="id" title="var">h1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">HAcc</span>; <span class="id" title="tactic">induction</span> <span class="id" title="keyword">wf</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h1</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">HAcc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> [= -&gt; -&gt;] <span class="id" title="var">HAcc</span>.<br/>
<span class="id" title="keyword">Restart</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="keyword">wf</span> [| <span class="id" title="var">h</span> <span class="id" title="var">t</span>]; <span class="id" title="tactic">constructor</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1 |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t'</span> <span class="id" title="var">VDDS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> <span class="id" title="var">Heql</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">VDDS</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> <span class="id" title="var">t''</span> <span class="id" title="var">r</span> | <span class="id" title="var">h'</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">VDDS</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> [= -&gt; -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">h</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="keyword">wf</span> <span class="id" title="var">h1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">induction</span> <span class="id" title="keyword">wf</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h1</span> <span class="id" title="var">H</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Hydra</span>  {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">Hydra_hydra</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>), <span class="id" title="var">Forall</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) <span class="id" title="var">l</span> -&gt; <span class="id" title="var">Hydra</span> <span class="id" title="var">R</span> <span class="id" title="var">l</span> [<span class="id" title="var">a</span>]<br/>
| <span class="id" title="var">Hydra_head</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> -&gt; <span class="id" title="var">Hydra</span> <span class="id" title="var">R</span> (<span class="id" title="var">h1</span> :: <span class="id" title="var">t</span>) (<span class="id" title="var">h2</span> :: <span class="id" title="var">t</span>)<br/>
| <span class="id" title="var">Hydra_tail</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">h</span> : <span class="id" title="var">A</span>) {<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hydra</span> <span class="id" title="var">R</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">Hydra</span> <span class="id" title="var">R</span> (<span class="id" title="var">h</span> :: <span class="id" title="var">t1</span>) (<span class="id" title="var">h</span> :: <span class="id" title="var">t2</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">List</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">BT</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">BT</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">E</span> : <span class="id" title="var">BT</span> <span class="id" title="var">A</span><br/>
| <span class="id" title="var">N</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BT</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BT</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BT</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">E</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">N</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">DeepDirectSubterm</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">BT</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BT</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">DDS_v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">v1</span> <span class="id" title="var">v2</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">l</span> <span class="id" title="var">r</span> : <span class="id" title="var">BT</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> -&gt; <span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> (<span class="id" title="var">N</span> <span class="id" title="var">v1</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) (<span class="id" title="var">N</span> <span class="id" title="var">v2</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>)<br/>
| <span class="id" title="var">DDS_l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">v</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> <span class="id" title="var">r</span> : <span class="id" title="var">BT</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">l</span> (<span class="id" title="var">N</span> <span class="id" title="var">v</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>)<br/>
| <span class="id" title="var">DDS_r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">v</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> <span class="id" title="var">r</span> : <span class="id" title="var">BT</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DeepDirectSubterm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> (<span class="id" title="var">N</span> <span class="id" title="var">v</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">BT</span>.<br/>
</div>
